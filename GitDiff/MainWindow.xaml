<Window x:Class="GitDiff.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:vm="clr-namespace:GitDiff.ViewModels"
        xmlns:converters="clr-namespace:GitDiff.Converters"
        mc:Ignorable="d"
        Title="Git Diff Extractor"
        Height="800" Width="1100"
        MinHeight="600" MinWidth="800"
        WindowStartupLocation="CenterScreen"
        Icon="pack://application:,,,/GitDiff.ico"
        Background="{DynamicResource MaterialDesign.Brush.Background}"
        FontFamily="{materialDesign:MaterialDesignFont}">

    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>

    <Window.Resources>
        <converters:StatusToColorConverter x:Key="StatusToColorConverter" />
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <converters:NullToBoolConverter x:Key="NullToBoolConverter" />
        <converters:CommitRoleConverter x:Key="CommitRoleConverter" />
    </Window.Resources>

    <DockPanel LastChildFill="True">
        <!-- Top toolbar: Repository path + filters in one compact row -->
        <ToolBarTray DockPanel.Dock="Top" IsLocked="True">
            <ToolBar Band="0" BandIndex="0" ClipToBounds="True"
                     Style="{DynamicResource MaterialDesignToolBar}">
                <materialDesign:PackIcon Kind="Git" Width="20" Height="20" VerticalAlignment="Center" />
                <TextBox Text="{Binding RepositoryPath, UpdateSourceTrigger=PropertyChanged}"
                         materialDesign:HintAssist.Hint="リポジトリパス"
                         materialDesign:TextFieldAssist.HasClearButton="True"
                         Width="360"
                         VerticalAlignment="Center"
                         Margin="4,0" />
                <Button Command="{Binding BrowseRepositoryCommand}"
                        Content="参照"
                        Style="{StaticResource MaterialDesignFlatButton}"
                        Padding="8,4" Height="28" />
                <Separator />
                <materialDesign:PopupBox StaysOpen="True"
                                         PlacementMode="BottomAndAlignLeftEdges"
                                         ToolTip="Committerフィルター"
                                         materialDesign:ElevationAssist.Elevation="Dp0">
                    <materialDesign:PopupBox.ToggleContent>
                        <Border BorderBrush="{DynamicResource MaterialDesign.Brush.ForegroundLight}"
                                BorderThickness="1" CornerRadius="3" Padding="8,4">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="AccountFilter" Width="16" Height="16"
                                                         VerticalAlignment="Center" Margin="0,0,4,0"
                                                         Foreground="{DynamicResource MaterialDesign.Brush.Foreground}" />
                                <TextBlock Text="{Binding CommitterFilterLabel}"
                                           VerticalAlignment="Center" FontSize="12"
                                           Foreground="{DynamicResource MaterialDesign.Brush.Foreground}" />
                                <materialDesign:PackIcon Kind="ChevronDown" Width="14" Height="14"
                                                         VerticalAlignment="Center" Margin="4,0,0,0"
                                                         Foreground="{DynamicResource MaterialDesign.Brush.ForegroundLight}" />
                            </StackPanel>
                        </Border>
                    </materialDesign:PopupBox.ToggleContent>
                    <StackPanel MinWidth="220" Margin="8">
                        <TextBox Text="{Binding CommitterFilterText, UpdateSourceTrigger=PropertyChanged}"
                                 materialDesign:HintAssist.Hint="フィルタ..."
                                 materialDesign:TextFieldAssist.HasClearButton="True"
                                 Margin="0,0,0,4" FontSize="12" />
                        <ScrollViewer MaxHeight="300" VerticalScrollBarVisibility="Auto">
                            <ItemsControl ItemsSource="{Binding FilteredCommitters}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox Content="{Binding Name}"
                                                  IsChecked="{Binding IsSelected}"
                                                  Margin="0,2" />
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                        <Separator Margin="0,6" />
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                            <Button Content="すべて選択"
                                    Command="{Binding SelectAllCommittersCommand}"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    Padding="8,2" Height="26" FontSize="11" />
                            <Button Content="クリア"
                                    Command="{Binding ClearAllCommittersCommand}"
                                    Style="{StaticResource MaterialDesignFlatButton}"
                                    Padding="8,2" Height="26" FontSize="11" />
                        </StackPanel>
                    </StackPanel>
                </materialDesign:PopupBox>
                <materialDesign:PopupBox StaysOpen="True"
                                         PlacementMode="BottomAndAlignLeftEdges"
                                         ToolTip="日付フィルター"
                                         materialDesign:ElevationAssist.Elevation="Dp0">
                    <materialDesign:PopupBox.ToggleContent>
                        <Border BorderBrush="{DynamicResource MaterialDesign.Brush.ForegroundLight}"
                                BorderThickness="1" CornerRadius="3" Padding="8,4">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="CalendarRange" Width="16" Height="16"
                                                         VerticalAlignment="Center" Margin="0,0,4,0"
                                                         Foreground="{DynamicResource MaterialDesign.Brush.Foreground}" />
                                <TextBlock Text="{Binding DateFilterLabel}"
                                           VerticalAlignment="Center" FontSize="12"
                                           Foreground="{DynamicResource MaterialDesign.Brush.Foreground}" />
                                <materialDesign:PackIcon Kind="ChevronDown" Width="14" Height="14"
                                                         VerticalAlignment="Center" Margin="4,0,0,0"
                                                         Foreground="{DynamicResource MaterialDesign.Brush.ForegroundLight}" />
                            </StackPanel>
                        </Border>
                    </materialDesign:PopupBox.ToggleContent>
                    <StackPanel MinWidth="220" Margin="8">
                        <TextBlock Text="From" FontSize="11" Margin="0,0,0,2"
                                   Foreground="{DynamicResource MaterialDesign.Brush.ForegroundLight}" />
                        <DatePicker SelectedDate="{Binding DateFrom}"
                                    materialDesign:HintAssist.Hint="開始日"
                                    FontSize="12" Margin="0,0,0,8" />
                        <TextBlock Text="To" FontSize="11" Margin="0,0,0,2"
                                   Foreground="{DynamicResource MaterialDesign.Brush.ForegroundLight}" />
                        <DatePicker SelectedDate="{Binding DateTo}"
                                    materialDesign:HintAssist.Hint="終了日"
                                    FontSize="12" Margin="0,0,0,4" />
                        <Separator Margin="0,6" />
                        <Button Content="クリア"
                                Command="{Binding ClearDateFilterCommand}"
                                Style="{StaticResource MaterialDesignFlatButton}"
                                HorizontalAlignment="Right"
                                Padding="8,2" Height="26" FontSize="11" />
                    </StackPanel>
                </materialDesign:PopupBox>
            </ToolBar>
        </ToolBarTray>

        <!-- Status Bar -->
        <StatusBar DockPanel.Dock="Bottom">
            <StatusBar.ItemsPanel>
                <ItemsPanelTemplate>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                    </Grid>
                </ItemsPanelTemplate>
            </StatusBar.ItemsPanel>
            <StatusBarItem Grid.Column="0">
                <TextBlock Text="{Binding StatusMessage}" />
            </StatusBarItem>
            <StatusBarItem Grid.Column="1">
                <TextBlock Text="{Binding DiffFileCount, StringFormat='Diff: {0} files'}" Margin="0,0,8,0" />
            </StatusBarItem>
            <StatusBarItem Grid.Column="2">
                <ProgressBar Style="{StaticResource MaterialDesignCircularProgressBar}"
                             IsIndeterminate="True"
                             Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}"
                             Value="0"
                             Width="16" Height="16" />
            </StatusBarItem>
        </StatusBar>

        <!-- Main content: Commits (top) + DiffFiles (bottom) with splitter -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="3*" MinHeight="120" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="2*" MinHeight="100" />
            </Grid.RowDefinitions>

            <!-- Commits -->
            <DockPanel Grid.Row="0">
                <TextBlock DockPanel.Dock="Top" Text="Commits" FontWeight="SemiBold" FontSize="12"
                           Margin="4,2,4,2" />
                <DataGrid x:Name="CommitsGrid"
                          ItemsSource="{Binding Commits}"
                          AutoGenerateColumns="False"
                          IsReadOnly="True"
                          SelectionMode="Extended"
                          PreviewMouseLeftButtonDown="CommitsGrid_PreviewMouseLeftButtonDown"
                          CanUserSortColumns="True"
                          CanUserResizeColumns="True"
                          HeadersVisibility="Column"
                          GridLinesVisibility="Horizontal"
                          BorderThickness="1"
                          BorderBrush="{DynamicResource MaterialDesign.Brush.TextBox.HoverBackground}"
                          RowHeight="28"
                          FontSize="12">
                    <DataGrid.Columns>
                        <DataGridTemplateColumn Header="" Width="48" CanUserSort="False" CanUserResize="False">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock FontWeight="Bold" FontSize="10" HorizontalAlignment="Center"
                                               VerticalAlignment="Center" Padding="2,0">
                                        <TextBlock.Text>
                                            <MultiBinding Converter="{StaticResource CommitRoleConverter}">
                                                <Binding />
                                                <Binding Path="DataContext.BaseCommit" RelativeSource="{RelativeSource AncestorType=DataGrid}" />
                                                <Binding Path="DataContext.TargetCommit" RelativeSource="{RelativeSource AncestorType=DataGrid}" />
                                            </MultiBinding>
                                        </TextBlock.Text>
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Style.Triggers>
                                                    <Trigger Property="Text" Value="Base">
                                                        <Setter Property="Foreground" Value="{DynamicResource PrimaryHueMidBrush}" />
                                                    </Trigger>
                                                    <Trigger Property="Text" Value="Target">
                                                        <Setter Property="Foreground" Value="{DynamicResource SecondaryHueMidBrush}" />
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                        <DataGridTextColumn Header="Hash" Binding="{Binding ShortHash}" Width="70" />
                        <DataGridTextColumn Header="Message" Binding="{Binding Message}" Width="*" />
                        <DataGridTextColumn Header="Author" Binding="{Binding Author}" Width="110" />
                        <DataGridTextColumn Header="Date" Binding="{Binding DateString}" Width="120" />
                    </DataGrid.Columns>
                </DataGrid>
            </DockPanel>

            <GridSplitter Grid.Row="1" Height="4" HorizontalAlignment="Stretch"
                          Background="{DynamicResource MaterialDesign.Brush.TextBox.HoverBackground}"
                          ResizeDirection="Rows" />

            <!-- Bottom section: Base/Target bar + Diff Files + Export -->
            <DockPanel Grid.Row="2">
                <!-- Export bar (below diff results) -->
                <DockPanel DockPanel.Dock="Bottom" Margin="4,2,4,4">
                    <Button DockPanel.Dock="Right"
                            Command="{Binding ExportCommand}"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            materialDesign:ButtonAssist.CornerRadius="3"
                            Padding="12,4" Height="30">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Export" Width="16" Height="16" Margin="0,0,4,0" />
                            <TextBlock Text="Export" />
                        </StackPanel>
                    </Button>
                    <Button DockPanel.Dock="Right"
                            Command="{Binding GenerateC0CasesCommand}"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            materialDesign:ButtonAssist.CornerRadius="3"
                            Padding="12,4" Height="30" Margin="0,0,8,0">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="TestTube" Width="16" Height="16" Margin="0,0,4,0" />
                            <TextBlock Text="C0ケース作成" />
                        </StackPanel>
                    </Button>
                    <TextBlock />
                </DockPanel>

                <!-- Base/Target + Compare bar -->
                <DockPanel DockPanel.Dock="Top" Margin="4,4,4,2">
                    <Button DockPanel.Dock="Right"
                            Command="{Binding CompareCommand}"
                            Style="{StaticResource MaterialDesignRaisedSecondaryButton}"
                            materialDesign:ButtonAssist.CornerRadius="3"
                            Padding="12,4" Height="30" Margin="8,0,0,0">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Compare" Width="16" Height="16" Margin="0,0,4,0" />
                            <TextBlock Text="Compare" />
                        </StackPanel>
                    </Button>
                    <CheckBox DockPanel.Dock="Right"
                              IsChecked="{Binding ExcludeMergeCommits}"
                              Content="Mergeコミットを除外"
                              VerticalAlignment="Center"
                              Margin="8,0,0,0"
                              FontSize="12"
                              ToolTip="マージコミットを差分検出から除外します" />
                    <materialDesign:PopupBox DockPanel.Dock="Right"
                                             PlacementMode="BottomAndAlignRightEdges"
                                             StaysOpen="True"
                                             Margin="8,0,0,0"
                                             Height="30"
                                             ToolTip="Compare時のCommitterフィルター"
                                             materialDesign:ElevationAssist.Elevation="Dp0">
                        <materialDesign:PopupBox.ToggleContent>
                            <Border BorderBrush="{DynamicResource MaterialDesign.Brush.ForegroundLight}"
                                    BorderThickness="1" CornerRadius="3" Padding="8,4">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="AccountFilter" Width="16" Height="16"
                                                             VerticalAlignment="Center" Margin="0,0,4,0"
                                                             Foreground="{DynamicResource MaterialDesign.Brush.Foreground}" />
                                    <TextBlock Text="{Binding CompareCommitterLabel}"
                                               VerticalAlignment="Center" FontSize="12"
                                               Foreground="{DynamicResource MaterialDesign.Brush.Foreground}" />
                                    <materialDesign:PackIcon Kind="ChevronDown" Width="14" Height="14"
                                                             VerticalAlignment="Center" Margin="4,0,0,0"
                                                             Foreground="{DynamicResource MaterialDesign.Brush.ForegroundLight}" />
                                </StackPanel>
                            </Border>
                        </materialDesign:PopupBox.ToggleContent>
                        <StackPanel MinWidth="200" Margin="8">
                            <ItemsControl ItemsSource="{Binding CompareCommitters}">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <CheckBox Content="{Binding Name}"
                                                  IsChecked="{Binding IsSelected}"
                                                  Margin="0,2" />
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            <Separator Margin="0,6" />
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button Content="すべて選択"
                                        Command="{Binding SelectAllCompareCommittersCommand}"
                                        Style="{StaticResource MaterialDesignFlatButton}"
                                        Padding="8,2" Height="26" FontSize="11" />
                                <Button Content="クリア"
                                        Command="{Binding ClearAllCompareCommittersCommand}"
                                        Style="{StaticResource MaterialDesignFlatButton}"
                                        Padding="8,2" Height="26" FontSize="11" />
                            </StackPanel>
                        </StackPanel>
                    </materialDesign:PopupBox>

                    <Grid VerticalAlignment="Center">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="Base:" VerticalAlignment="Center" Margin="0,0,4,0" FontWeight="SemiBold" />
                        <TextBlock Grid.Column="1" Text="{Binding BaseCommit.DisplayText, FallbackValue='(未選択)'}"
                                   VerticalAlignment="Center"
                                   Foreground="{DynamicResource PrimaryHueMidBrush}"
                                   TextTrimming="CharacterEllipsis"
                                   ToolTip="{Binding BaseCommit.DisplayText}" />
                        <materialDesign:PackIcon Grid.Column="2" Kind="ArrowRight" VerticalAlignment="Center" Margin="8,0" Width="18" Height="18" />
                        <TextBlock Grid.Column="3" Text="Target:" VerticalAlignment="Center" Margin="0,0,4,0" FontWeight="SemiBold" />
                        <TextBlock Grid.Column="4" Text="{Binding TargetCommit.DisplayText, FallbackValue='(未選択)'}"
                                   VerticalAlignment="Center"
                                   Foreground="{DynamicResource SecondaryHueMidBrush}"
                                   TextTrimming="CharacterEllipsis"
                                   ToolTip="{Binding TargetCommit.DisplayText}" />
                    </Grid>
                </DockPanel>

                <!-- Diff Files -->
                <DockPanel>
                <TextBlock DockPanel.Dock="Top" FontWeight="SemiBold" FontSize="12" Margin="4,2,4,2">
                    <Run Text="Diff Files" />
                    <Run Text="{Binding DiffFileCount, StringFormat='({0})'}" />
                </TextBlock>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="220" MinWidth="120" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!-- Folder Tree -->
                    <DockPanel Grid.Column="0">
                        <DockPanel DockPanel.Dock="Top" Margin="2,2,2,0">
                            <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                                <Button Content="All"
                                        Command="{Binding SelectAllFoldersCommand}"
                                        Style="{StaticResource MaterialDesignToolButton}"
                                        FontSize="10" Height="20" Padding="4,0" />
                                <Button Content="Clear"
                                        Command="{Binding ClearAllFoldersCommand}"
                                        Style="{StaticResource MaterialDesignToolButton}"
                                        FontSize="10" Height="20" Padding="4,0" />
                            </StackPanel>
                            <TextBlock Text="Folders" FontWeight="SemiBold" FontSize="11"
                                       VerticalAlignment="Center" />
                        </DockPanel>
                        <TreeView ItemsSource="{Binding FolderTree}"
                                  BorderThickness="1"
                                  BorderBrush="{DynamicResource MaterialDesign.Brush.TextBox.HoverBackground}"
                                  Padding="0"
                                  FontSize="12">
                            <TreeView.Resources>
                                <Style TargetType="TreeViewItem">
                                    <Setter Property="IsExpanded" Value="True" />
                                    <Setter Property="Margin" Value="0" />
                                    <Setter Property="Padding" Value="0" />
                                    <Setter Property="MinHeight" Value="0" />
                                    <Setter Property="Background" Value="Transparent" />
                                    <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="TreeViewItem">
                                                <StackPanel>
                                                    <Border x:Name="Bd" Background="{TemplateBinding Background}" Padding="0">
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="14" />
                                                                <ColumnDefinition Width="*" />
                                                            </Grid.ColumnDefinitions>
                                                            <ToggleButton x:Name="Expander"
                                                                          IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
                                                                          ClickMode="Press" Focusable="False"
                                                                          Width="14" Height="14">
                                                                <ToggleButton.Template>
                                                                    <ControlTemplate TargetType="ToggleButton">
                                                                        <Border Background="Transparent">
                                                                            <Path x:Name="Arrow"
                                                                                  Data="M0,0 L5,4 L0,8"
                                                                                  Stroke="{DynamicResource MaterialDesign.Brush.ForegroundLight}"
                                                                                  StrokeThickness="1.2"
                                                                                  VerticalAlignment="Center"
                                                                                  HorizontalAlignment="Center"
                                                                                  RenderTransformOrigin="0.5,0.5" />
                                                                        </Border>
                                                                        <ControlTemplate.Triggers>
                                                                            <Trigger Property="IsChecked" Value="True">
                                                                                <Setter TargetName="Arrow" Property="Data" Value="M0,0 L5,5 L10,0" />
                                                                            </Trigger>
                                                                        </ControlTemplate.Triggers>
                                                                    </ControlTemplate>
                                                                </ToggleButton.Template>
                                                            </ToggleButton>
                                                            <ContentPresenter Grid.Column="1"
                                                                              ContentSource="Header"
                                                                              HorizontalAlignment="Stretch" />
                                                        </Grid>
                                                    </Border>
                                                    <ItemsPresenter x:Name="ItemsHost" Margin="10,0,0,0" />
                                                </StackPanel>
                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsExpanded" Value="False">
                                                        <Setter TargetName="ItemsHost" Property="Visibility" Value="Collapsed" />
                                                    </Trigger>
                                                    <Trigger Property="HasItems" Value="False">
                                                        <Setter TargetName="Expander" Property="Visibility" Value="Hidden" />
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </TreeView.Resources>
                            <TreeView.ItemTemplate>
                                <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                    <CheckBox IsChecked="{Binding IsSelected}"
                                              Content="{Binding Name}"
                                              Margin="0,-2,0,-2" Padding="2,0"
                                              MinHeight="0" MinWidth="0"
                                              Height="20" />
                                </HierarchicalDataTemplate>
                            </TreeView.ItemTemplate>
                        </TreeView>
                    </DockPanel>

                    <!-- Vertical Splitter -->
                    <GridSplitter Grid.Column="1" Width="4"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Stretch"
                                  Background="{DynamicResource MaterialDesign.Brush.TextBox.HoverBackground}"
                                  ResizeDirection="Columns" />

                    <!-- Diff Files DataGrid -->
                    <DataGrid Grid.Column="2"
                              x:Name="DiffFilesGrid"
                              ItemsSource="{Binding DiffFiles}"
                              AutoGenerateColumns="False"
                              IsReadOnly="True"
                              CanUserSortColumns="True"
                              CanUserResizeColumns="True"
                              HeadersVisibility="Column"
                              GridLinesVisibility="Horizontal"
                              BorderThickness="1"
                              BorderBrush="{DynamicResource MaterialDesign.Brush.TextBox.HoverBackground}"
                              FontSize="12"
                              MouseDoubleClick="DiffFilesGrid_MouseDoubleClick">
                        <DataGrid.Columns>
                            <DataGridTemplateColumn Header="Status" Width="70" SortMemberPath="StatusText">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding StatusText}"
                                                   Foreground="{Binding Status, Converter={StaticResource StatusToColorConverter}}"
                                                   FontWeight="Bold" FontSize="11" />
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                            <DataGridTextColumn Header="File Path" Binding="{Binding FilePath}" Width="*" />
                            <DataGridTextColumn Header="Old Path" Binding="{Binding OldPath}" Width="180" />
                        </DataGrid.Columns>
                    </DataGrid>
                </Grid>
                </DockPanel>
            </DockPanel>
        </Grid>
    </DockPanel>
</Window>
